<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="utf-8" />
	<title>Thông tin cá nhân</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="Premium Bootstrap 4 Landing Page Template" />
	<meta name="keywords" content="Appointment, Booking, System, Dashboard, Health" />
	<meta name="author" content="Shreethemes" />
	<meta name="email" content="support@shreethemes.in" />
	<meta name="website" content="../../../index.html" />
	<meta name="Version" content="v1.2.0" />
	<!-- favicon -->
	<link rel="shortcut icon" th:href="@{/static/assets/images/favicon.ico.png}">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
		integrity="sha512-..." crossorigin="anonymous" />

	<!-- Bootstrap -->
	<link th:href="@{/static/assets/css/bootstrap.min.css}" rel="stylesheet" type="text/css" />
	<!-- simplebar -->
	<link th:href="@{/static/assets/css/simplebar.css}" rel="stylesheet" type="text/css" />
	<!-- Icons -->
	<link th:href="@{/static/assets/css/materialdesignicons.min.css}" rel="stylesheet" type="text/css" />
	<link th:href="@{/static/assets/css/remixicon.css}" rel="stylesheet" type="text/css" />
	<link href="https://unicons.iconscout.com/release/v3.0.6/css/line.css" rel="stylesheet">
	<!-- Css -->
	<link th:href="@{/static/assets/css/style.min.css}" rel="stylesheet" type="text/css" id="theme-opt" />
	<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
	<style>
		.btn-edit-product {
			display: none;
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
		}
	</style>

</head>

<body>
	<!-- Loader -->
	<div id="preloader">
		<div id="status">
			<div class="spinner">
				<div class="double-bounce1"></div>
				<div class="double-bounce2"></div>
			</div>
		</div>
	</div>
	<!-- Loader -->

	<div class="page-wrapper doctris-theme toggled">
		<nav id="sidebar" class="sidebar-wrapper">
			<div class="sidebar-content" data-simplebar style="height: calc(100% - 60px);">
				<div class="sidebar-brand">
					<a href="/home">
						<img th:src="@{/static/assets/images/logo-2.png}" height="24" class="logo-light-mode" alt=""
							style="height: 55px;margin-left: 50px;">
						<img th:src="@{/static/assets/images/logo-2.png}" height="24" class="logo-dark-mode" alt=""
							style="height: 55px;margin-left: 50px;">
					</a>
				</div>

				<ul class="sidebar-menu pt-3">

                     <li><a href="/home"><i class="uil uil-home me-2 d-inline-block"></i>Home</a>
					</li>
					<li><a href="/profile"><i class="uil uil-user me-2 d-inline-block"></i>Thông tin cá nhân</a>
					</li>
					<li><a href="/my-order"><i class="uil uil-shopping-bag me-2 d-inline-block"></i>Đơn hàng</a>
					</li>

					<li class="sidebar-dropdown">
						<a href="javascript:void(0)"><i
								class="uil uil-sign-in-alt me-2 d-inline-block"></i>Authentication</a>
						<div class="sidebar-submenu">
							<ul>
								<li><a href="/login">Login</a></li>
								<li><a href="/logout">Signup</a></li>
								<li><a href="forgot-password.html">Forgot Password</a></li>
								<li><a href="lock-screen.html">Lock Screen</a></li>
								<li><a href="thankyou.html">Thank you...!</a></li>
							</ul>
						</div>
					</li>

				</ul>
				<!-- sidebar-menu  -->
			</div>
			<!-- sidebar-content  -->
			<ul class="sidebar-footer list-unstyled mb-0">
				<li class="list-inline-item mb-0 ms-1">
					<a href="#" class="btn btn-icon btn-pills btn-soft-primary">
						<i class="uil uil-comment icons"></i>
					</a>
				</li>
			</ul>
		</nav>
		<!-- sidebar-wrapper  -->

		<!-- Start Page Content -->
		<main class="page-content bg-light">
			<div class="top-header">
				<div class="header-bar d-flex justify-content-between border-bottom">
					<div class="d-flex align-items-center">
						<a href="#" class="logo-icon">
							<img th:src="@{/static/assets/images/logo-icon.png}" height="30" class="small" alt="">
							<span class="big">
								<img th:src="@{/static/assets/images/logo-dark.png}" height="24" class="logo-light-mode"
									alt="">
								<img th:src="@{/static/assets/images/logo-light.png}" height="24" class="logo-dark-mode"
									alt="">
							</span>
						</a>
						<a id="close-sidebar" class="btn btn-icon btn-pills btn-soft-primary ms-2" href="#">
							<i class="uil uil-bars"></i>
						</a>
						<div class="search-bar p-0 d-none d-lg-block ms-2">
							<div id="search" class="menu-search mb-0">
								<form role="search" method="get" id="searchform" class="searchform">
									<div>
										<input type="text" class="form-control border rounded-pill" name="s" id="s"
											placeholder="Search Keywords...">
										<input type="submit" id="searchsubmit" value="Search">
									</div>
								</form>
							</div>
						</div>
					</div>

					<ul class="list-unstyled mb-0">





						<li class="list-inline-item mb-0 ms-1">
							<div class="dropdown dropdown-primary">
								<button type="button" class="btn btn-pills btn-soft-primary dropdown-toggle p-0"
									data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><img
										id="avatartop" th:src="${user.image_Avt.url}"
										class="avatar avatar-ex-small rounded-circle" alt=""></button>
								<div class="dropdown-menu dd-menu dropdown-menu-end bg-white shadow border-0 mt-3 py-3"
									style="min-width: 200px;">
									<a class="dropdown-item d-flex align-items-center text-dark">
										<img th:src="${user.image_Avt.url}"
											class="avatar avatar-md-sm rounded-circle border shadow" alt="">
										<div class="flex-1 ms-2">
											<span class="d-block mb-1" th:text="${user.username}"></span>
											<small class="text-muted" th:text="${user.role.name}"></small>
										</div>
									</a>
									<a class="dropdown-item text-dark" href="/home"><span
											class="mb-0 d-inline-block me-1"><i
												class="uil uil-dashboard align-middle h6"></i></span> Home</a>
									<a class="dropdown-item text-dark" href="/my-order"><span
											class="mb-0 d-inline-block me-1"><i
												class="uil uil-setting align-middle h6"></i></span> Đơn hàng</a>
									<div class="dropdown-divider border-top"></div>
									<a class="dropdown-item text-dark" href="/logout"><span
											class="mb-0 d-inline-block me-1"><i
												class="uil uil-sign-out-alt align-middle h6"></i></span> Logout</a>
								</div>
							</div>
						</li>
					</ul>
				</div>
			</div>

			<div class="container-fluid">
				<div class="layout-specing">
					<div class="row">
						<div class="col-lg-9 col-md-7 mt-4" style="margin-left: auto;margin-right: auto;">
							<div class="card border-0 shadow overflow-hidden">


								<div class="tab-content p-4" id="pills-tabContent">
									<div th:if="${msg1 != null}"  class="alert alert-success">
										<p style="text-align: center; font-size: 20px;" th:text="${msg1}"></p>
									</div>
									<div th:if="${msg != null}" class="alert alert-danger ">
										<p style="text-align: center; font-size: 20px;" th:text="${msg}"></p>
									</div>

									<div class="tab-pane fade show active" id="pills-experience" role="tabpanel"
										aria-labelledby="experience-tab">
										<h5 class="mb-0">Thông tin cá nhân </h5>


										<div class="row align-items-center mt-4">
											<div class="col-lg-3 col-md-4">

											</div><!--end col-->
											<div class="col-lg-6 col-md-3">
												<div class="image-container position-relative">
													<img th:src="${user.image_Avt.url}" id="current-avatar"
														class="avatar avatar-md-md rounded-pill shadow mx-auto d-block"
														alt="" style="height: 150px; width: 150px;">
													<a class="btn btn-icon btn-pills btn-soft-success btn-edit-product"
														data-bs-toggle="modal" data-bs-target="#edit_avatar" style="display: none;position: absolute;
			                                             	top: 50%; left: 50% ;transform: translate(-50%, -50%); "><i
															class="uil uil-pen"></i></a>
												</div>
												<div class="modal fade " id="edit_avatar" tabindex="-1"
													aria-labelledby="exampleModalLabel" aria-hidden="true">
													<div class="modal-dialog ">
														<div class="modal-content">
															<div class="modal-header border-bottom p-3">
																<h5 class="modal-title" id="exampleModalLabel">Avatar
																</h5>
																<button type="button" class="btn-close"
																	data-bs-dismiss="modal" aria-label="Close"></button>
															</div>
															<div class="modal-body p-1 pt-4">

																<form class="mt-4" method="post">
																	<div class="container"
																		style="height: 300px; overflow-y: auto;">
																		<div class="row align-items-center">
																			<div class="col-6 col-sm-3 col-sm-3 col-md-3 image-item"
																				th:each="i : ${listI}"
																				style="display: flex;">
																				<img th:src="${i.url}"
																					th:data-id="${i.id}"
																					th:data-url="${i.url}"
																					data-bs-target="#editavatar"
																					class="avatar avatar-md-md rounded-pill shadow mx-auto mb-3"
																					alt=""
																					style="height: 80px;width: 80px;display: flex;">

																			</div>

																		</div><!--end row-->

																	</div>
																</form><!--end form-->
															</div>
														</div>
													</div>
												</div>

											</div><!--end row-->
											<div class="col-lg-3 col-md-4">

											</div><!--end col-->

										</div>

										<form class="mt-4" th:action="@{/update-profile}" method="post"
											th:object="${user}">
											<div class="row">

												<input name="id" id="id" type="hidden" th:field="*{username}"
													class="form-control">

												<div class="col-lg-6">
													<div class="mb-3">
														<label class="form-label">Full Name</label>
														<input name="name" id="name2" type="text" th:field="*{fullname}"
															class="form-control">
													</div>
												</div><!--end col-->

												<div class="col-lg-6">
													<div class="mb-3">
														<label class="form-label">Email</label>
														<input name="email" id="email" th:field="*{email}" type="email"
															class="form-control" readonly>
													</div>
												</div><!--end col-->

												<div class="col-lg-6">
													<div class="mb-3">
														<label class="form-label">Phone no.</label>
														<input name="number" id="number" th:field="*{phone}" type="text"
															class="form-control">
													</div>
												</div><!--end col-->
												<div class="col-lg-6">
													<div class="mb-3">
														<label class="form-label">Address</label>
														<input name="address" id="address" th:field="*{address}"
															type="text" class="form-control">
													</div>
												</div><!--end col-->


											</div><!--end row-->

											<div class="row">
												<div class="col-sm-12">
													<input type="submit" id="submit" name="send" class="btn btn-primary"
														value="Save changes">
												</div><!--end col-->
											</div><!--end row-->
										</form><!--end form-->

										<div class="mt-4 pt-2">
											<h5 class="mb-0">Change Password :</h5>

											<form class="mt-4" th:action="@{/changepass}" method="post"
												th:object="${user}">
												<div class="row">

													<div class="col-lg-12">
														<div class="mb-3">
															<label class="form-label">Old password :</label>
															<input type="password" name="oldpass" class="form-control"
																required="">
														</div>
													</div><!--end col-->

													<div class="col-lg-12">
														<div class="mb-3">
															<label class="form-label">New password :</label>
															<input type="password" name="newpass" class="form-control"
																required="">
														</div>
													</div><!--end col-->

													<div class="col-lg-12">
														<div class="mb-3">
															<label class="form-label">Re-type New password :</label>
															<input type="password" name="renewpass" class="form-control"
																required="">
														</div>
													</div><!--end col-->

													<div class="col-lg-12 mt-2 mb-0">
														<button class="btn btn-primary">Save password</button>
													</div><!--end col-->
												</div><!--end row-->
											</form>
										</div>

										<div class="mt-4 pt-2">
											<h5 class="mb-0 text-danger">Delete Account :</h5>

											<p class="mb-0 mt-4">Do you want to delete the account? Please press below
												"Delete" button</p>
											<div class="mt-4">
												<button class="btn btn-danger">Delete Account</button>
											</div><!--end col-->
										</div>
									</div>
								</div>
							</div>
						</div><!--end col-->


					</div><!--end row-->
				</div>
			</div><!--end container-->

			<!-- Footer Start -->
			<footer class="bg-white shadow py-3">
				<div class="container-fluid">
					<div class="row align-items-center">
						<div class="col">
							<div class="text-sm-start text-center">
								<p class="mb-0 text-muted">
									<script>document.write(new Date().getFullYear())</script> © Doctris. Design with <i
										class="mdi mdi-heart text-danger"></i> by <a href="/home" target="_blank"
										class="text-reset">Tunnee</a>.
								</p>
							</div>
						</div><!--end col-->
					</div><!--end row-->
				</div><!--end container-->
			</footer><!--end footer-->
			<!-- End -->
		</main>

	</div>

	<script>
		document.addEventListener('DOMContentLoaded', function () {
			var links = document.querySelectorAll('[data-bs-target="#editavatar"]');

			links.forEach(function (link) {
				link.addEventListener('click', function () {
					var id = link.dataset.id;
					var url = link.dataset.url;
					var modal = document.getElementById('edit_avatar');
					if (modal) {
						$(modal).modal('hide');
					}
					updateAvatar(id);

					document.getElementById('avatartop').src = url;
					document.getElementById('current-avatar').src = url;


				});
			});
		});

		function updateAvatar(id) {
			fetch('/api/user/update-avatar', {
				method: 'POST',
				headers: {
					'Content-Type': 'application/x-www-form-urlencoded',
				},
				body: `id=${id}`,
			})
				.then(response => {
					if (!response.ok) {
						throw new Error('Lỗi mạng');
					}
				})
				.catch(error => {
					console.error('Lỗi: ' + error);
				});
		}
	</script>


	<script>
		$(document).ready(function () {
			$('.image-container').hover(
				function () {
					$(this).find('.btn-edit-product').fadeIn();
				},
				function () {
					$(this).find('.btn-edit-product').fadeOut();
				}
			);
		});
	</script>

	<!-- javascript -->
	<script th:src="@{/static/assets/js/bootstrap.bundle.min.js}"></script>
	<!-- simplebar -->
	<script th:src="@{/static/assets/js/simplebar.min.js}"></script>
	<!-- Icons -->
	<!-- Icons -->
	<script th:src="@{/static/assets/js/feather.min.js}"></script>
	<!-- Main Js -->
	<script th:src="@{/static/assets/js/app.js}"></script>

</body>

</html>